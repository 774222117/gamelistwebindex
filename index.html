<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<meta name="description" content="W4PLAY,天天都玩好游戏，折扣游戏，电脑游戏">
		<meta name="keywords" content="W4PLAY,天天都玩好游戏">
		<meta name="generator" content="w4play">
		<title>W4PLAY-天天都玩好游戏</title>
		<link rel="stylesheet" type="text/css" href="css/public.css" />
		<link rel="icon" href="images/favicon.ico">
		<link rel="stylesheet" type="text/css" href="css/index.css" />
		<title></title>
		<style type="text/css">

		</style>
		<script>
			var _hmt = _hmt || [];
			(function() {
				var hm = document.createElement("script");
				hm.src = "https://hm.baidu.com/hm.js?8bbe8c6cac719022db98e1c5afcb9c29";
				var s = document.getElementsByTagName("script")[0];
				s.parentNode.insertBefore(hm, s);
			})();
		</script>
		<!-- ocpc -->
		<script type="text/javascript">
			window._agl = window._agl || [];
			(function() {
				_agl.push(
					['production', '_f7L2XwGXjyszb4d1e2oxPybgD']
				);
				(function() {
					var agl = document.createElement('script');
					agl.type = 'text/javascript';
					agl.async = true;
					agl.src = 'https://fxgate.baidu.com/angelia/fcagl.js?production=_f7L2XwGXjyszb4d1e2oxPybgD';
					var s = document.getElementsByTagName('script')[0];
					s.parentNode.insertBefore(agl, s);
				})();
			})();
		</script>
	</head>
	<body>
		<div class="container">
			<!-- 首页弹窗 -->
			<div class="alertContent unActive">
				<div class="newUserAlert">
					<div class="gameContent">
						<div class="bottomLeft">
							<div class="leftBtn"></div>
						</div>
						<div class="bottomContent">
							<div class="contentGameBox">
								
								<!-- <div class="contentItem">
									<img src="./images/游戏图.png" alt="">
									<div class="itemPrice ft16"><span class="ft12">￥</span>125</div>
									<div class="gameName ft14">方舟：生存进化</div>
								</div> -->
								
							</div>
						</div>
						<div class="bottomRight">
							<div class="rightBtn"></div>
						</div>
						
						
					</div>
					<div class="freeGet"></div>
					<div class="close"></div>
				</div>
			</div>
			<!-- 整个背景 -->
			<div class="backgroundBox">
				<!-- 顶部 -->
				<div class="head">
					<div class="headLogo">
						<!-- <iframe class="titleLogo" src="images/titleLogo.svg" frameborder="0"></iframe> -->
					</div>
					<div class="headDown"></div>
				</div>
				<!-- 轮播图 -->
				<div class="banner">
					<!-- 轮播背景底图 -->
					<div class="bannerBackground"></div>
					<!-- 轮播图片 -->
					<div class="bannerContent">
						<div class="bannerSwiper">
							<!-- <img src="images/头.png" alt=""> -->
						</div>
					</div>
					<!-- 轮播游戏名称 -->
					<div class="swiperChange">
						<!-- <div class="gameItemChange ischange">
							<div class="gameName ft16">方舟：生存进化</div>
						</div> -->
					</div>
					<!-- 轮播下载按钮 -->
					<div class="downGameBtn"></div>
				</div>
				<!-- 折扣热销 -->
				<div class="discountHot">
					<div class="discountTitle margin-left">
						<div class="discountLogoBox">
							<div class="titleLogo dicountLogo"></div>
							<div class="titleText ft24">折扣热销</div>
						</div>
						<!-- 查看更多 -->
						<div class="watchMore">
							<div class="watchText ft12">查看更多</div>
						</div>
					</div>
					<!-- 折扣商品 -->
					<div class="discountCommodity">
						<div class="leftBtn">
							<div class="leftbutton"></div>
						</div>
						<div class="centerCommodityBox">
							<div class="centerCommodity">
								<!-- 单个游戏 -->
								<!-- <div class="centerCommodityItem">
									<div class="itemPic">
										<img src="images/游戏图.png" >
										<div class="discount">
											<div class="dicountNumber ft18">-75%</div>
										</div>
										<div class="price">
											<div class="nowPirce ft18"><span class="ft12">￥</span>125</div>
											<div class="oldPrice ft12">255</div>
										</div>
										
									</div>
									<div class="discountShadow unActive">
										<div class="discountBuy"></div>
									</div>
									<div class="itemGameName ft16">方舟：生存进化</div>
								</div> -->

							</div>
						</div>
						<div class="rightBtn">
							<div class="rightbutton"></div>
						</div>
					</div>
				</div>
				<!-- 热销排行 -->
				<div class="hotRanking">
					<div class="discountTitle">
						<div class="discountLogoBox">
							<div class="titleLogo hotRankingLogo"></div>
							<div class="titleText ft24">热销排行</div>
						</div>
						<!-- 查看更多 -->
						<div class="watchMore">
							<div class="watchText ft12">查看更多</div>
						</div>
					</div>
					<!-- 热销商品 -->
					<div class="rankingItemBox">

						<!-- <div class="rankingItem noRanking">
							<div class="leftPicture">
								<img src="images/横图.png" alt="">
								<div class="gameNum gameNum1"></div>
							</div>
							<div class="rightInfo">
								<div class="name ft16">方舟：生存进化</div>
								<div class="player ft12"><span>21221</span>人正在玩</div>
								<div class="gamePrice">
									<div class="nowPrice ft18 ft_weight"><span class="ft12">￥</span>125</div>
									<div class="oldPrice ft12">255</div>
								</div>
							</div>
						</div> -->

					</div>
				</div>
				<!-- 新品上新 -->
				<div class="newProducts">
					<div class="discountTitle">
						<div class="discountLogoBox">
							<div class="titleLogo newProductLogo"></div>
							<div class="titleText ft24">新品上新</div>
						</div>
						<!-- 查看更多 -->
						<div class="watchMore">
							<div class="watchText ft12">查看更多</div>
						</div>
					</div>

					<!-- 游戏区域 -->
					<div class="newProductsItemContent">

						<!-- 单个游戏盒子 -->

						<!-- <div class="newProductsItem noProduct">
							<div class="leftPicture">
								<img src="images/游戏图.png" alt="">
								<div class="discount ft18 ft_weight">-75%</div>
							</div>
							<div class="rightInfo">
								<div class="nameContent">
									<div class="name ft16 ft_weight">方舟：生存进化</div>
									<div class="icon"></div>
								</div>
								<div class="people ft12">21221人正在玩</div>
								<div class="gamePrice">
									<div class="nowPrice ft18 ft_weight"><span>￥</span>125</div>
									<div class="oldPrice ft12">255</div>
								</div>
								<div class="moreDiscount">
									<div class="howDiscount ft12">7折</div>
									<div class="province ft12">立省39.9</div>
								</div>
							</div>
						</div> -->

					</div>
				</div>
				<!-- 公司介绍 -->
				<div class="companyIntro">
					<div class="companyStatement">
						<div class="text1 ft16">W4PLAY</div>
						<div class="text2 ft14">声明：本站只提供正版游戏代充值服务，不涉及游戏发行，推广及代理。</div>
						<div class="text3 ft14">Play More Shouldn't Cost More</div>
					</div>
					<div class="companyItem">
						<div class="text1 ft16">关于我们</div>
						<div class="text2 ft14 aboutUs">公司简介</div>
						<div class="text3 ft14 privacy">用户隐私协议</div>
					</div>
					<div class="companyPay">
						<div class="text1 ft14">安全支付</div>
						<div class="payType">
							<div class="wxchat"></div>
							<div class="alipay"></div>
						</div>
					</div>
				</div>
				<!-- 公司名称 -->
				<div class="companyName">
					<div class="companyText ft14">
						<span class="text1"></span>
						<span class="text2"></span>
					</div>
				</div>
				<!-- 底部新人下载 -->
				<div class="bottomDown"></div>
			</div>
		</div>
	</body>
	<script type="text/javascript" src="js/domin.js"></script>
	<script type="text/javascript" src="js/jquery.js"></script>
	<script type="text/javascript" src="js/public.js"></script>
	<script type="text/javascript">
		$(function() {
			// 点击用户隐私协议
			$('.companyItem .privacy').click(function(){
				window.open('privacy.html')
			})
			
			// 点击公司简介
			$('.companyItem .aboutUs').click(function(){
				window.open('aboutUs.html')
			})
			
			// 进页面7秒之后打开弹窗
			setTimeout(function(){
				$('.alertContent').removeClass('unActive').addClass('isActive')
			},7000)
			
			// 关闭弹窗按钮
			$('.newUserAlert .close').click(function(){
				$('.alertContent').removeClass('isActive').addClass('unActive')
			})
			
			// 点击弹窗往右按钮
			$('.bottomRight .rightBtn').click(function(){
				$('.contentGameBox').css('transform', 'translateX(' + -5 + 'rem' + ')')
			})
			$('.bottomLeft .leftBtn').click(function(){
				$('.contentGameBox').css('transform', 'translateX(' + 0 + 'rem' + ')')
			})
			
			// 新品上新 鼠标移入商品
			$('.newProductsItemContent').on('mouseover', '.newProductsItem', function() {
				// console.log($(this).data('index'))
				var productNum = $(this).data('index')
				$($('.newProductsItem')[productNum]).removeClass('noProduct').addClass('isProduct')
			})
			$('.newProductsItemContent').on('mouseleave', '.newProductsItem', function() {
				var productNum = $(this).data('index')
				$($('.newProductsItem')[productNum]).removeClass('isProduct').addClass('noProduct')
			})

			// 热销排行 鼠标移入商品
			$('.rankingItemBox').on('mouseover', '.rankingItem', function() {
				var rankNum = $(this).data('index')
				// console.log(rankNum)
				$($('.rankingItem')[rankNum]).removeClass('noRanking').addClass('isRanking')
			})
			$('.rankingItemBox').on('mouseleave', '.rankingItem', function() {
				var rankNum = $(this).data('index')
				$($('.rankingItem')[rankNum]).removeClass('isRanking').addClass('noRanking')
			})

			// 折扣热销 鼠标移入商品
			$('.centerCommodity').on('mouseover', '.centerCommodityItem', function() {
				var changeNum = $(this).data('index');
				// console.log($('.centerCommodityItem')[changeNum])
				$($('.centerCommodityItem')[changeNum]).find('.discountShadow').removeClass('unActive')
					.addClass('isActive')
			})
			$('.centerCommodity').on('mouseleave', '.centerCommodityItem', function() {
				var changeNum = $(this).data('index');
				$($('.centerCommodityItem')[changeNum]).find('.discountShadow').removeClass('isActive')
					.addClass('unActive')
			})

			// 点击 折扣热销 往右按钮
			$('.rightbutton').click(function() {
				console.log('11')
				$('.centerCommodity').css('transform', 'translateX(' + -12.46 + 'rem' + ')')
			})
			$('.leftbutton').click(function() {
				console.log('222')
				$('.centerCommodity').css('transform', 'translateX(' + 0 + 'rem' + ')')
			})

			// 轮播图title鼠标移入事件
			$('.swiperChange .gameItemChange').mouseover(function() {
				var activeNum = $(this).data('index');
				$('.bannerContent').css('transform', 'translateX(' + -19.20 * activeNum + 'rem' + ')')
				$(this).addClass('ischange').siblings().removeClass('ischange')
			})
		})

		// 根据域名获取版本号GET
		function getlocalhost() {
			$.ajax({
				url: onekeytestDomin + '/channel/copyright',
				type: 'GET', // jsonp模式只有GET是合法的
				data: {
					'www': window.location.host
				}, // 预传参的数组
				dataType: 'json', // 数据类型
				jsonp: 'callback', // 指定回调函数名，与服务器端接收的一致，并回传回来
				success: function(res) {
					// console.log(res)
					if (res.flag) {
						$('.companyName .companyText .text1').html(res.data.copyright)
						$('.companyName .companyText .text2').html(res.data.recordNumber)
					} else {
						console.log('获取公司信息数据请求失败')
					}
				}
			})
		}


		// 获取顶部轮播图数据
		function getSwiperInfo() {
			$.ajax({
				async: false, //同步加载数据，等到ajax执行完毕再接着执行下面的语句
				url: onekeytestDomin + '/index/v2/banners1',
				type: 'GET',
				dataType: "json", //数据类型
				jsonp: 'callback', //指定回调函数名，与服务器接收的一致，并回传回来
				data: {
					'codes': 'ldyimages'
				},
				success: function(res) {
					// console.log(res)
					if (res) {
						var banner = '';
						var gameName = ''
						res.data.forEach(function(v, i) {
							// console.log(v)
							banner += `
								<div class="bannerSwiper">
									<img src="${v.bannerImg}" alt="gameImg">
								</div>`;
							gameName += `
								<div class="gameItemChange" data-index="${i}">
									<div class="gameName ft16">${v.gameName}</div>
								</div>`
						})
						$('.bannerContent').html(banner);
						$('.banner .swiperChange').html(gameName)

					} else {
						console.log('轮播图数据加载失败')
					}

					// 获取当前播放的游戏data-index值
					var activeNum = $('.gameItemChange').data('index');
					// console.log(activeNum)
					$($('.gameItemChange')[0]).addClass('ischange')
					// 轮播图定时器
					var timer = setInterval(function() {
						activeNum++;
						if (activeNum == 5) {
							activeNum = 0
						}
						// console.log($('.gameItemChange')[activeNum])
						$($('.gameItemChange')[activeNum]).addClass('ischange').siblings().removeClass(
							'ischange');
						$('.bannerContent').css('transform', 'translateX(' + -19.20 * activeNum + 'rem' +
							')')
					}, 3000)
					// 鼠标移入轮播定时器关闭
					$('.swiperChange .gameItemChange').mouseover(function(){
						clearInterval(timer)
					})
					$('.swiperChange .gameItemChange').mouseleave(function(){
						timer = setInterval(function() {
							activeNum++;
							if (activeNum == 5) {
								activeNum = 0
							}
							// console.log($('.gameItemChange')[activeNum])
							$($('.gameItemChange')[activeNum]).addClass('ischange').siblings().removeClass(
								'ischange');
							$('.bannerContent').css('transform', 'translateX(' + -19.20 * activeNum + 'rem' +
								')')
						}, 3000)
					})
				}
			})
		}


		// 获取新品上新数据
		// 最近上架 https://gsource.sgsugou.com/app/index/findData orderType 2
		function getNewProducts() {
			$.ajax({
				url: onekeytestDomin + '/index/findData',
				type: 'GET',
				data: {
					'current': 1,
					'limit': 6,
					'orderType': 2,
				},
				success: function(res) {
					// console.log(res)
					if (res.flag) {
						var newProducts = '';
						res.data.rows.forEach(function(v, i) {
							// console.log(v)
							newProducts += `
							<div class="newProductsItem noProduct" data-index='${i}'>
								<!-- 左边图片 -->
								<div class="leftPicture">
									<img src="${v.libraryCapsule}" alt="">
									<div class="discount ft18 ft_weight">
										<div class="discountPoint">-${(Math.ceil((1 - (v.lowPrice/v.steamPrce).toFixed(2)) * 100))}%</div>
									</div>
								</div>
								<!-- 右边游戏信息 -->
								<div class="rightInfo">
									<!-- 游戏名称 -->
									<div class="nameContent">
										<div class="name ft16 ft_weight">${v.chinaName || v.englishName}</div>
										<div class="icon"></div>
									</div>
									<!-- 正在游玩 -->
									<div class="people ft12">${v.playersNow} 人正在玩</div>
									<!-- 游戏价格 -->
									<div class="gamePrice">
										<div class="nowPrice ft18 ft_weight"><span>￥</span>${v.lowPrice}</div>
										<div class="oldPrice ft12">${v.steamPrce}</div>
									</div>
									<!-- 折扣和立省 -->
									<div class="moreDiscount">
										<!-- 多少折 -->
										<div class="howDiscount ft12">${(v.lowPrice/v.steamPrce).toFixed(2)}折</div>
										<!-- 立省 -->
										<div class="province ft12">立省${v.steamPrce - v.lowPrice}</div>
									</div>
								</div>
							</div>`
						})
						$('.newProductsItemContent').html(newProducts);
					} else {
						console.log('新品上新 数据请求失败')
					}
				}
			})
		}

		// 获取热销排行游戏数据
		// https://gsource.sgsugou.com/app/index/findData orderType 3
		function getHotRanking() {
			$.ajax({
				url: onekeytestDomin + '/index/findData',
				type: 'GET',
				data: {
					'current': 1,
					'limit': 6,
					'orderType': 3
				},
				success: function(res) {
					// console.log(res)
					if (res.flag) {
						var hotRanking = '';
						res.data.rows.forEach(function(v, i) {
							// console.log(v)
							hotRanking += `
								<div class="rankingItem noRanking" data-index='${i}'>
									<!-- 左边游戏封面 -->
									<div class="leftPicture">
										<img src="${v.image}" alt="">
										<div class="gameNum gameNum${i + 1}"></div>
									</div>
									<!-- 右边游戏详情 -->
									<div class="rightInfo">
										<div class="name ft16">${v.chinaName || v.englishName}</div>
										<div class="player ft12"><span>${v.playersNow}</span>人正在玩</div>
										<div class="gamePrice">
											<div class="nowPrice ft18 ft_weight"><span class="ft12">￥</span>${v.lowPrice}</div>
											<div class="oldPrice ft12">${v.steamPrce}</div>
										</div>
									</div>
								</div>`
						})
						$('.rankingItemBox').html(hotRanking);
					} else {
						console.log('热销排行 数据请求失败')
					}
				}
			})
		}

		// 获取折扣热销游戏数据
		// https://gsource.sgsugou.com/app/index/findData current 1   limlit 10  orderType1
		function getDiscount() {
			// 保存域名获取的指定游戏
			var channelGame = []
			// 保存其他游戏
			var discountGame = {}
			var totalGame = {}
			// 保存所有游戏
			var showNum = 0
			// 如果是渠道域名进来，则只获取9条数组 + 一条渠道游戏数据
			if (appid == '') {
				showNum = 10;
				
			} else {
				showNum = 9;
				var appid = getQueryStringRegExp('appid') || '';
				// console.log(appid)
				// 请求热销获取带appid进来的游戏数据
				$.ajax({
					async: false, //同步加载数据,等到ajax执行完毕再接着执行下面的语句
					url:onekeytestDomin + '/game/landingTopHot',
					// url: 'https://gsource.sgsugou.com/app/game/landingTopHot?appids=998940',
					type: 'GET', //jsonp模式只有GET是合法的
					data: {
						'appids': appid
					},
					dataType: 'json', //数据类型
					jsonp: 'callback', //指定回调函数名，与服务器端接收的一致，并回传回来
					success: function(json) {
						// console.log(json.data)
						channelGame = json.data[0]
						// console.log(channelGame)
						$.ajax({
							url: onekeytestDomin + '/index/findData',
							type: 'GET',
							data: {
								'current': 1,
								'limit': showNum,
								'orderType': 1,
							},
							success: function(res) {
								// console.log(res)
								discountGame = res.data.rows
								discountGame.unshift(channelGame)
								// console.log(discountGame)
							
								var discountItem = ''
								discountGame.forEach(function(v, i) {
									// console.log(v)
									discountItem += `
										<div class="centerCommodityItem" data-index="${i}">
											<div class="itemPic">
												<img src="${v.libraryCapsule}" >
												<div class="picShadow"></div>
												<div class="discount">
													<div class="dicountNumber ft18">-${((1 - (v.lowPrice/v.steamPrce)) * 100).toFixed()}%</div>
												</div>
												<div class="price">
													<div class="nowPirce ft18 ft_weight"><span class="ft12">￥</span>${v.lowPrice}</div>
													<div class="oldPrice ft12">${v.steamPrce}</div>
												</div>
												
											</div>
											<div class="discountShadow unActive">
												<div class="discountBuy"></div>
											</div>
											<div class="itemGameName ft16">${v.chinaName || v.englishName}</div>
										</div>`
								
								
								})
								$('.centerCommodity').html(discountItem)
							}
						})
					}
				})
			}
		}

		



		getDiscount()
		getlocalhost()
		getAlertGame()
		getHotRanking()
		getNewProducts()
		getSwiperInfo()
		// 保存域名获取的指定游戏
		var channelGame = {}
		var appid = getQueryStringRegExp('appid') || '';
		var channelIds = getQueryStringRegExp('channel') || '';
		var down = getQueryStringRegExp('down') || ''; //如果down为1 则下载链接添加 appid拼接
		function getQueryStringRegExp(name) {
			// http://www.w4play.com/?channel=BDTG1&appid=252950&down=1
			var reg = new RegExp("(^|\\?|&)" + name + "=([^&]*)(\\s|&|$)", "i");
			// 取出渠道ID号
			if (reg.test(location.href)) return unescape(RegExp.$2.replace(/\+/g, " "));
			return "";
		};
		if (appid == 1238860 || appid == 271590 || appid == 1124300) {
			appid = null
			$('body').html('').addClass('backBlack')
		} else {
			// 获取渠道下载信息
			$(document).ready(function() {
				$.ajax({
					async: false, //同步加载数据，等到ajax执行完毕再接着执行下面的语句
					url: onekeytestDomin + '/channel/cdl',
					type: "GET", //jsonp模式只有GET是合法的
					data: {
						"channelAbbr": channelIds
					}, //预传参的数组
					dataType: "json", //数据类型
					jsonp: 'callback', //指定回调函数名，与服务器接收的一致，并回传回来
					success: function(json) {
						//保存原本的url
						var oldHref =
							'https://grsource.we4game.com/packet/channel/SteamOnline_w4play.exe'
						if (down == 1) {
							oldHref = 'https://grsource.we4game.com/packet/channel/SteamOnline_' +
								channelIds + '_' + appid + '.exe'
						} else if (channelIds !== '') {
							oldHref = 'https://grsource.we4game.com/packet/channel/SteamOnline_' +
								channelIds + '.exe'
						}
						// 顶部下载客户端
						$('.headDown').click(function() {
							addChannelId()
							window.open(oldHref)
						})
						// 点击轮播图下载查看更多游戏特惠
						$('.downGameBtn').click(function() {
							addChannelId()
							window.open(oldHref)
						})
						// 点击 新品上新商品下载客户端
						$('.newProductsItemContent').on('click', '.newProductsItem', function() {
							addChannelId()
							window.open(oldHref)
						})
						// 点击 热销排行商品下载客户端
						$('.rankingItemBox').on('click', '.rankingItem', function() {
							addChannelId()
							window.open(oldHref)
						})
						// 点击 折扣热销商品下载客户端
						$('.centerCommodity').on('click', '.centerCommodityItem', function() {
							addChannelId()
							window.open(oldHref)
						})
						// 点击 查看更多 >
						$('.watchMore').click(function() {
							addChannelId()
							window.open(oldHref)
						})
						// 点击轮播图
						$('.bannerBackground').click(function() {
							addChannelId()
							window.open(oldHref)
						})
						// 点击最底部安装领取
						$('.bottomDown').click(function(){
							addChannelId()
							window.open(oldHref)
						})
						// 点击弹窗 免费领取按钮
						$('.freeGet').click(function(){
							addChannelId()
							window.open(oldHref)
						})
						// 点击轮播图游戏名称下载
						$('.swiperChange .gameItemChange').click(function(){
							addChannelId()
							window.open(oldHref)
						})
					}
				})
			})
		}
		// 统计点击下载渠道
		function addChannelId() {
			$.ajax({
				async: false, //同步加载数据，等到ajax执行完毕再接着执行下面的语句
				url: onekeytestDomin + '/channel/index',
				type: "POST",
				data: {
					'channelId': channelIds,
					'channelLogType': 'DOWNLOAD'
				},
				dataType: 'json', //数据类型
				success: function(json) {
					console.log('统计成功')
				}
			})
		}
		
		//api.we4game.com/app/people/activity/brief?appids=
		function getAlertGame(){
			$.ajax({
				url: onekeytestDomin + '/people/activity/brief',
				type:'GET',
				success:function(res){
					// console.log(res)
					// 取10个游戏
					var alertGame = res.data.slice(0,8)
					// console.log(alertGame)
					var alertItem = '';
					alertGame.forEach(function(v,i){
						// console.log(v)
						alertItem += `
							<div class="contentItem">
								<img src="${v.libraryCapsule}" alt="">
								<div class="itemPrice ft16"><span class="ft12">￥</span>${v.worth}</div>
								<div class="gameName ft14">${v.chinaName || v.englishName}</div>
							</div>`
					})
					$('.contentGameBox').html(alertItem)
				}
			})
		}
	</script>
</html>
